import React, { Component } from 'react'
import { Link } from 'react-router-dom'
import { Pane, Button, toaster } from 'evergreen-ui';
import { Redirect } from 'react-router';
import api from '../../../interceptor/AxiosInterceptor';


export class Login extends Component {
    constructor(props) {
        super(props);
        this.state = {
            username: '',
            password: '',
            redirect: false
        };
    }
    getUsername = (event) => {
        this.setState({ username: event.target.value })
    }

    getPassword = (event) => {
        this.setState({ password: event.target.value })
    }
    checkAuthentication = () => {
        if (!this.state.username || !this.state.password) {
            alert('Tên đăng nhập hoặc mật khẩu không đúng')
        }
    }


    login = async () => {
        let loginForm = {
            'email' : this.state.username,
            'password' : this.state.password
        }
        
        api.post('auth/login', loginForm).then((res) => {
            localStorage.setItem('accessToken', res.data.accessToken)
            localStorage.setItem('refreshToken', res.data.refreshToken)
            this.setState({ redirect: true })
        }).catch((err) => {
            if (err.response) {
                if (err.response.data === 'Enter not enough information') {
                    toaster.danger('Vui lòng nhập đủ thông tin');
                } 
            } else {
                toaster.danger('Tài khoản hoặc mật khẩu không đúng');
            }
        })
    }
    render() {
        if (this.state.redirect) {
            return <Redirect to='/lead' />;
        }
        return (
            <Pane className='w-full h-full flex justify-center items-center'>
                <Pane className='login-form rounded-2xl flex flex-col p-6 shadow-lg'>
                    <Pane className='mb-6 w-full h-12 flex justify-center items-center'>
                        <svg width="150" height="48" viewBox="0 0 108 35" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M7.11503 19.9371C8.78445 15.7599 12.7807 11.1924 13.9992 9.85678V8.42676L13.6413 8.80035C13.3839 9.06864 8.69459 13.9972 6.50134 18.8757C6.3216 19.276 6.15887 19.6755 6.01638 20.0725C5.62452 21.1641 5.38488 22.2339 5.38488 23.2268C5.38488 30.0685 12.903 31.3439 12.9791 31.3556L13.5523 31.4467L12.5451 30.2657C10.8878 29.8445 6.3718 28.2373 6.3718 23.2259C6.3718 22.5205 6.50782 21.7658 6.74503 20.9844C6.79604 20.813 7.07374 20.075 7.11503 19.9371Z" fill="black" />
                            <path d="M2.03388 20.8724C2.03388 18.7938 2.39821 16.4803 3.98181 13.8735C4.10164 12.879 4.334 11.9044 4.72504 10.9851C1.71084 14.5221 1 18.3333 1 20.8724C1 29.9272 8.61282 34 14.0186 34V32.9795C9.04191 32.9795 2.03388 29.2235 2.03388 20.8724Z" fill="black" />
                            <path d="M13.9992 2.28125V1L13.6826 1.2616C13.5936 1.33515 11.4675 3.09948 9.30747 5.6528C6.36937 9.1263 4.87968 12.2396 4.87968 14.9066C4.87968 15.4632 4.89992 16.0207 4.95416 16.5748C5.00112 17.0537 5.07318 17.5301 5.18409 17.999C5.28206 18.4143 5.41079 18.8222 5.57757 19.2159C5.69091 19.4825 5.81317 19.7407 5.96861 19.9848C6.11353 20.2129 6.27465 20.4311 6.44952 20.6367C6.82195 21.0755 7.25914 21.429 7.71738 21.7759C7.95217 21.9539 8.19506 22.1378 8.4177 22.3308C10.951 24.5306 12.3686 27.2594 12.5443 30.2557L13.5515 31.4367L13.5499 30.8633C13.5418 27.3405 11.9922 24.1378 9.06944 21.5995C8.8217 21.3847 8.56586 21.19 8.31731 21.0028C8.09628 20.8348 7.87364 20.6676 7.66314 20.4871C7.56032 20.3985 7.46073 20.3074 7.3652 20.2113C7.31824 20.1636 7.27209 20.1152 7.22837 20.065C7.07293 19.8895 6.93529 19.6989 6.81223 19.5C6.68674 19.2969 6.59363 19.0846 6.49891 18.8657C6.06415 17.8577 5.86498 16.5915 5.86498 14.9066C5.8666 9.71302 12.4625 3.6277 13.9992 2.28125Z" fill="black" />
                            <path d="M20.8485 19.9371C19.1791 15.7599 15.1828 11.1924 13.9644 9.85678V8.42676L14.3222 8.80035C14.5797 9.06864 19.269 13.9972 21.4622 18.8757C21.642 19.276 21.8047 19.6755 21.9472 20.0725C22.339 21.1641 22.5787 22.2339 22.5787 23.2268C22.5787 30.0685 15.0606 31.3439 14.9845 31.3556L14.4113 31.4467L15.4184 30.2657C17.0757 29.8445 21.5918 28.2373 21.5918 23.2259C21.5918 22.5205 21.4557 21.7658 21.2185 20.9844C21.1675 20.813 20.8898 20.075 20.8485 19.9371Z" fill="black" />
                            <path d="M25.9661 20.8724C25.9661 18.7938 25.6018 16.4803 24.0182 13.8735C23.8984 12.879 23.666 11.9044 23.275 10.9851C26.2892 14.5213 27 18.3324 27 20.8715C27 29.9264 19.3872 33.9992 13.9814 33.9992V32.9787C18.9581 32.9795 25.9661 29.2235 25.9661 20.8724Z" fill="black" />
                            <path d="M13.9644 2.28125V1L14.2809 1.2616C14.37 1.33515 16.496 3.09948 18.6561 5.6528C21.5942 9.1263 23.0839 12.2396 23.0839 14.9066C23.0839 15.4632 23.0636 16.0207 23.0094 16.5748C22.9624 17.0537 22.8904 17.5301 22.7795 17.999C22.6815 18.4143 22.5528 18.8222 22.386 19.2159C22.2727 19.4825 22.1504 19.7407 21.995 19.9848C21.85 20.2129 21.6889 20.4311 21.514 20.6367C21.1416 21.0755 20.7044 21.429 20.2462 21.7759C20.0114 21.9539 19.7685 22.1378 19.5459 22.3308C17.0126 24.5306 15.5949 27.2594 15.4193 30.2557L14.4121 31.4367L14.4137 30.8633C14.4218 27.3405 15.9714 24.1378 18.8941 21.5995C19.1419 21.3847 19.3977 21.19 19.6463 21.0028C19.8673 20.8348 20.0899 20.6676 20.3004 20.4871C20.4032 20.3985 20.5028 20.3074 20.5984 20.2113C20.6453 20.1636 20.6915 20.1152 20.7352 20.065C20.8906 19.8895 21.0283 19.6989 21.1513 19.5C21.2768 19.2969 21.3699 19.0846 21.4647 18.8657C21.8994 17.8577 22.0986 16.5915 22.0986 14.9066C22.097 9.71302 15.501 3.6277 13.9644 2.28125Z" fill="black" />
                            <path d="M7.11503 19.9371C8.78445 15.7599 12.7807 11.1924 13.9992 9.85678V8.42676L13.6413 8.80035C13.3839 9.06864 8.69459 13.9972 6.50134 18.8757C6.3216 19.276 6.15887 19.6755 6.01638 20.0725C5.62452 21.1641 5.38488 22.2339 5.38488 23.2268C5.38488 30.0685 12.903 31.3439 12.9791 31.3556L13.5523 31.4467L12.5451 30.2657C10.8878 29.8445 6.3718 28.2373 6.3718 23.2259C6.3718 22.5205 6.50782 21.7658 6.74503 20.9844C6.79604 20.813 7.07374 20.075 7.11503 19.9371Z" stroke="black" strokeWidth="0.3" />
                            <path d="M2.03388 20.8724C2.03388 18.7938 2.39821 16.4803 3.98181 13.8735C4.10164 12.879 4.334 11.9044 4.72504 10.9851C1.71084 14.5221 1 18.3333 1 20.8724C1 29.9272 8.61282 34 14.0186 34V32.9795C9.04191 32.9795 2.03388 29.2235 2.03388 20.8724Z" stroke="black" strokeWidth="0.3" />
                            <path d="M13.9992 2.28125V1L13.6826 1.2616C13.5936 1.33515 11.4675 3.09948 9.30747 5.6528C6.36937 9.1263 4.87968 12.2396 4.87968 14.9066C4.87968 15.4632 4.89992 16.0207 4.95416 16.5748C5.00112 17.0537 5.07318 17.5301 5.18409 17.999C5.28206 18.4143 5.41079 18.8222 5.57757 19.2159C5.69091 19.4825 5.81317 19.7407 5.96861 19.9848C6.11353 20.2129 6.27465 20.4311 6.44952 20.6367C6.82195 21.0755 7.25914 21.429 7.71738 21.7759C7.95217 21.9539 8.19506 22.1378 8.4177 22.3308C10.951 24.5306 12.3686 27.2594 12.5443 30.2557L13.5515 31.4367L13.5499 30.8633C13.5418 27.3405 11.9922 24.1378 9.06944 21.5995C8.8217 21.3847 8.56586 21.19 8.31731 21.0028C8.09628 20.8348 7.87364 20.6676 7.66314 20.4871C7.56032 20.3985 7.46073 20.3074 7.3652 20.2113C7.31824 20.1636 7.27209 20.1152 7.22837 20.065C7.07293 19.8895 6.93529 19.6989 6.81223 19.5C6.68674 19.2969 6.59363 19.0846 6.49891 18.8657C6.06415 17.8577 5.86498 16.5915 5.86498 14.9066C5.8666 9.71302 12.4625 3.6277 13.9992 2.28125Z" stroke="black" strokeWidth="0.3" />
                            <path d="M20.8485 19.9371C19.1791 15.7599 15.1828 11.1924 13.9644 9.85678V8.42676L14.3222 8.80035C14.5797 9.06864 19.269 13.9972 21.4622 18.8757C21.642 19.276 21.8047 19.6755 21.9472 20.0725C22.339 21.1641 22.5787 22.2339 22.5787 23.2268C22.5787 30.0685 15.0606 31.3439 14.9845 31.3556L14.4113 31.4467L15.4184 30.2657C17.0757 29.8445 21.5918 28.2373 21.5918 23.2259C21.5918 22.5205 21.4557 21.7658 21.2185 20.9844C21.1675 20.813 20.8898 20.075 20.8485 19.9371Z" stroke="black" strokeWidth="0.3" />
                            <path d="M25.9661 20.8724C25.9661 18.7938 25.6018 16.4803 24.0182 13.8735C23.8984 12.879 23.666 11.9044 23.275 10.9851C26.2892 14.5213 27 18.3324 27 20.8715C27 29.9264 19.3872 33.9992 13.9814 33.9992V32.9787C18.9581 32.9795 25.9661 29.2235 25.9661 20.8724Z" stroke="black" strokeWidth="0.3" />
                            <path d="M13.9644 2.28125V1L14.2809 1.2616C14.37 1.33515 16.496 3.09948 18.6561 5.6528C21.5942 9.1263 23.0839 12.2396 23.0839 14.9066C23.0839 15.4632 23.0636 16.0207 23.0094 16.5748C22.9624 17.0537 22.8904 17.5301 22.7795 17.999C22.6815 18.4143 22.5528 18.8222 22.386 19.2159C22.2727 19.4825 22.1504 19.7407 21.995 19.9848C21.85 20.2129 21.6889 20.4311 21.514 20.6367C21.1416 21.0755 20.7044 21.429 20.2462 21.7759C20.0114 21.9539 19.7685 22.1378 19.5459 22.3308C17.0126 24.5306 15.5949 27.2594 15.4193 30.2557L14.4121 31.4367L14.4137 30.8633C14.4218 27.3405 15.9714 24.1378 18.8941 21.5995C19.1419 21.3847 19.3977 21.19 19.6463 21.0028C19.8673 20.8348 20.0899 20.6676 20.3004 20.4871C20.4032 20.3985 20.5028 20.3074 20.5984 20.2113C20.6453 20.1636 20.6915 20.1152 20.7352 20.065C20.8906 19.8895 21.0283 19.6989 21.1513 19.5C21.2768 19.2969 21.3699 19.0846 21.4647 18.8657C21.8994 17.8577 22.0986 16.5915 22.0986 14.9066C22.097 9.71302 15.501 3.6277 13.9644 2.28125Z" stroke="black" strokeWidth="0.3" />
                            <path d="M41.6818 26C46.3352 26 49.0945 23.1214 49.0945 18.3487C49.0945 13.5909 46.3352 10.7273 41.7862 10.7273H36.5064V26H41.6818ZM39.2731 23.6062V13.1211H41.6296C44.7319 13.1211 46.3501 14.8512 46.3501 18.3487C46.3501 21.8612 44.7319 23.6062 41.5476 23.6062H39.2731ZM53.8642 26L55.1245 22.234H60.8667L62.1344 26H65.0875L59.7033 10.7273H56.2878L50.911 26H53.8642ZM55.8702 20.0117L57.9359 13.8594H58.0552L60.1209 20.0117H55.8702ZM68.0992 10.7273V26H70.754V15.4851H70.8957L75.1166 25.9553H77.1002L81.3211 15.5075H81.4628V26H84.1176V10.7273H80.732L76.1979 21.794H76.0189L71.4848 10.7273H68.0992ZM90.8971 10.7273H88.1304V26H90.8971V10.7273ZM107.444 10.7273H104.692V21.1378H104.558L97.369 10.7273H94.8931V26H97.6598V15.5969H97.7866L104.983 26H107.444V10.7273Z" fill="black" />
                        </svg>
                    </Pane>
                    <Pane className='mb-4'>
                        <Pane className='py-2 px-4 flex flex-col h-16 sv-bgr'>
                            <Pane className='text-sm font-medium'>Tài khoản</Pane>
                            <input type='text' className='input-field' onChange={this.getUsername}></input>
                        </Pane>
                    </Pane>
                    <Pane className='mb-4'>
                        <Pane className='py-2 px-4 flex flex-col h-16 sv-bgr'>
                            <Pane className='text-sm font-medium'>Mật khẩu</Pane>
                            <input type='password' className='input-field' onChange={this.getPassword}></input>
                        </Pane>
                    </Pane>
                    <Pane className='flex items-center justify-center mb-4'>
                        <Pane className='mr-2'>
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M13 5.142V7.278C13.595 7.625 14 8.263 14 9V11C14 12.103 13.103 13 12 13H8C6.897 13 6 12.103 6 11V9C6 7.897 6.897 7 8 7H9V5H8C5.794 5 4 6.794 4 9V11C4 13.206 5.794 15 8 15H12C14.206 15 16 13.206 16 11V9C16 7.141 14.721 5.589 13 5.142Z" fill="#11142D" />
                                <path d="M8 1H4C1.794 1 0 2.794 0 5V7C0 8.859 1.279 10.411 3 10.858V8.722C2.405 8.375 2 7.737 2 7V5C2 3.897 2.897 3 4 3H8C9.103 3 10 3.897 10 5V7C10 8.103 9.103 9 8 9H7V11H8C10.206 11 12 9.206 12 7V5C12 2.794 10.206 1 8 1Z" fill="#11142D" />
                            </svg>
                        </Pane>
                        <Link to=''>
                            <Pane className='font-semibold text-sm text-blue-600'>
                                Quên mật khẩu
                            </Pane>
                        </Link>
                    </Pane>
                    <Pane className='h-14 flex items-center justify-center mb-4'>
                        <Button appearance="primary" onClick={this.login}>
                            Đăng nhập
                        </Button>
                    </Pane>
                    <Link to='/signup'>
                        <Pane className='font-semibold text-sm text-blue-600 flex justify-center'>
                            Đăng ký tài khoản
                        </Pane>
                    </Link>
                </Pane>
            </Pane>
        )
    }
}

export default Login
